{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-infinity-scroll.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './api';\n\niziToast.settings({\n  position: 'topRight',\n  transitionIn: 'bounceInDown',\n  closeOnEscape: true,\n});\n\nconst refs = {\n  input: document.querySelector('input'),\n  button: document.querySelector('.js-search-button'),\n  gallery: document.querySelector('.gallery'),\n  guard: document.querySelector('.js-guard'),\n};\n\nrefs.input.addEventListener('input', onInputChange);\nrefs.button.addEventListener('click', onClickButton);\n\nlet value = '';\nlet page = 1;\nlet totalPages = 0;\n\nconst observerOptions = {\n  root: null,\n  rootMargin: window.innerHeight * 0.5 + 'px',\n  threshold: 0,\n};\n\nlet observer = new IntersectionObserver(onLoadMore, observerOptions);\n\nfunction onInputChange(e) {\n  e.preventDefault();\n  value = e.target.value.trim();\n}\n\nfunction onClickButton(e) {\n  e.preventDefault();\n  clearGallery();\n  checkEmptyValue() && fetchData(page, value);\n}\n\nasync function fetchData(page, value) {\n await fetchImages(page, value)\n    .then(data => {\n      createMarkup(data);\n    })\n    .catch(err => {\n      iziToast.error({\n        message: 'Something went wrong :-( try again later.',\n      });\n    });\n}\n\nfunction createMarkup({ hits, totalHits }) {\n  if (hits.length === 0) {\n    return iziToast.info({\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n  }\n  showSuccessMessage(page, totalHits);\n  hits.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      const imgMarkup = `\n        <li class=\"photo-card\">\n          <a class=\"gallery-link\" href = ${largeImageURL}>\n            <img src=${webformatURL} alt=${tags} loading=\"lazy\" />\n          </a>\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                <span>${numberWithSpaces(likes)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                <span>${numberWithSpaces(views)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                <span>${numberWithSpaces(comments)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                <span>${numberWithSpaces(downloads)}</span>\n              </p>\n            </div>\n          </li>`;\n      lightbox.refresh();\n      refs.gallery.insertAdjacentHTML('beforeend', imgMarkup);\n    }\n  );\n  totalPages = Math.ceil(totalHits / 40);\n  observer.observe(refs.guard);\n}\n\nfunction clearGallery() {\n  page = 1;\n  totalPages = 0;\n  observer.disconnect(refs.guard);\n  refs.gallery.innerHTML = '';\n}\n\nfunction checkEmptyValue() {\n  if (value.length === 0) {\n    refs.input.value = '';\n    iziToast.warning({\n      message: 'You should enter something to input!',\n    });\n    return false;\n  }\n  return true;\n}\n\nfunction showSuccessMessage(page, totalHits) {\n  if (page === 1) {\n    iziToast.success({\n      message: `Hooray! We found ${totalHits} images.`,\n    });\n  }\n}\n\nfunction numberWithSpaces(num) {\n  return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n\nconst lightbox = new SimpleLightbox('.photo-card a', {\n  sourceAttr: 'href',\n  overlay: true,\n  nav: true,\n});\n\nfunction onLoadMore(entries) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n      if (page <= totalPages) {\n        fetchData(page, value);\n      } else {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    }\n  });\n}\n"],"names":["iziToast","refs","onInputChange","onClickButton","value","page","totalPages","observerOptions","observer","onLoadMore","clearGallery","checkEmptyValue","fetchData","fetchImages","data","createMarkup","err","hits","totalHits","showSuccessMessage","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgMarkup","numberWithSpaces","lightbox","num","SimpleLightbox","entries","entry"],"mappings":"wIAIAA,EAAS,SAAS,CAChB,SAAU,WACV,aAAc,eACd,cAAe,EACjB,CAAC,EAED,MAAMC,EAAO,CACX,MAAO,SAAS,cAAc,OAAO,EACrC,OAAQ,SAAS,cAAc,mBAAmB,EAClD,QAAS,SAAS,cAAc,UAAU,EAC1C,MAAO,SAAS,cAAc,WAAW,CAC3C,EAEAA,EAAK,MAAM,iBAAiB,QAASC,CAAa,EAClDD,EAAK,OAAO,iBAAiB,QAASE,CAAa,EAEnD,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAa,EAEjB,MAAMC,EAAkB,CACtB,KAAM,KACN,WAAY,OAAO,YAAc,GAAM,KACvC,UAAW,CACb,EAEA,IAAIC,EAAW,IAAI,qBAAqBC,EAAYF,CAAe,EAEnE,SAASL,EAAc,EAAG,CACxB,EAAE,eAAc,EAChBE,EAAQ,EAAE,OAAO,MAAM,KAAI,CAC7B,CAEA,SAASD,EAAc,EAAG,CACxB,EAAE,eAAc,EAChBO,IACAC,KAAqBC,EAAUP,EAAMD,CAAK,CAC5C,CAEA,eAAeQ,EAAUP,EAAMD,EAAO,CACrC,MAAMS,EAAYR,EAAMD,CAAK,EACzB,KAAKU,GAAQ,CACZC,EAAaD,CAAI,CACvB,CAAK,EACA,MAAME,GAAO,CACZhB,EAAS,MAAM,CACb,QAAS,2CACjB,CAAO,CACP,CAAK,CACL,CAEA,SAASe,EAAa,CAAE,KAAAE,EAAM,UAAAC,GAAa,CACzC,GAAID,EAAK,SAAW,EAClB,OAAOjB,EAAS,KAAK,CACnB,QACE,0EACR,CAAK,EAEHmB,EAAmBd,EAAMa,CAAS,EAClCD,EAAK,IACH,CAAC,CACC,aAAAG,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACN,IAAU,CACJ,MAAMC,EAAY;AAAA;AAAA,2CAEmBN;AAAA,uBACpBD,SAAoBE;AAAA;AAAA;AAAA;AAAA;AAAA,wBAKnBM,EAAiBL,CAAK;AAAA;AAAA;AAAA;AAAA,wBAItBK,EAAiBJ,CAAK;AAAA;AAAA;AAAA;AAAA,wBAItBI,EAAiBH,CAAQ;AAAA;AAAA;AAAA;AAAA,wBAIzBG,EAAiBF,CAAS;AAAA;AAAA;AAAA,iBAI5CG,EAAS,QAAO,EAChB5B,EAAK,QAAQ,mBAAmB,YAAa0B,CAAS,CACvD,CACL,EACErB,EAAa,KAAK,KAAKY,EAAY,EAAE,EACrCV,EAAS,QAAQP,EAAK,KAAK,CAC7B,CAEA,SAASS,GAAe,CACtBL,EAAO,EACPC,EAAa,EACbE,EAAS,WAAWP,EAAK,KAAK,EAC9BA,EAAK,QAAQ,UAAY,EAC3B,CAEA,SAASU,GAAkB,CACzB,OAAIP,EAAM,SAAW,GACnBH,EAAK,MAAM,MAAQ,GACnBD,EAAS,QAAQ,CACf,QAAS,sCACf,CAAK,EACM,IAEF,EACT,CAEA,SAASmB,EAAmBd,EAAMa,EAAW,CACvCb,IAAS,GACXL,EAAS,QAAQ,CACf,QAAS,oBAAoBkB,WACnC,CAAK,CAEL,CAEA,SAASU,EAAiBE,EAAK,CAC7B,OAAOA,EAAI,SAAU,EAAC,QAAQ,wBAAyB,GAAG,CAC5D,CAEA,MAAMD,EAAW,IAAIE,EAAe,gBAAiB,CACnD,WAAY,OACZ,QAAS,GACT,IAAK,EACP,CAAC,EAED,SAAStB,EAAWuB,EAAS,CAC3BA,EAAQ,QAAQC,GAAS,CACnBA,EAAM,iBACR5B,GAAQ,EACJA,GAAQC,EACVM,EAAUP,EAAMD,CAAK,EAErBJ,EAAS,KAAK,CACZ,QAAS,4DACnB,CAAS,EAGT,CAAG,CACH"}