{"version":3,"file":"commonHelpers.js","sources":["../src/js/01-load-more.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './api';\n\niziToast.settings({\n  position: 'topRight',\n  transitionIn: 'bounceInDown',\n  closeOnEscape: true,\n});\n\nconst refs = {\n  input: document.querySelector('input'),\n  button: document.querySelector('.js-search-button'),\n  gallery: document.querySelector('.gallery'),\n  loadMore: document.querySelector('.js-load-more'),\n};\n\nrefs.input.addEventListener('input', onInputChange);\nrefs.button.addEventListener('click', onClickButton);\nrefs.loadMore.addEventListener('click', onLoadMoreClick);\n\nlet value = '';\nlet page = 1;\n\nfunction onInputChange(e) {\n  e.preventDefault();\n  value = e.target.value.trim();\n}\n\nfunction onClickButton(e) {\n  e.preventDefault();\n  clearGallery();\n  checkEmptyValue() && fetchData(page, value);\n}\n\nfunction fetchData(page, value) {\n  fetchImages(page, value)\n    .then(data => {\n      createMarkup(data);\n    })\n    .catch(err => {\n      iziToast.error({\n        message: 'Something went wrong :-( try again later.',\n      });\n    });\n}\n\nfunction createMarkup({ hits, totalHits }) {\n  if (hits.length === 0) {\n    return iziToast.info({\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n    });\n  }\n  showLoadMore(totalHits);\n  hits.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      const imgMarkup = `\n        <li class=\"photo-card\">\n          <a class=\"gallery-link\" href = ${largeImageURL}>\n            <img src=${webformatURL} alt=${tags} loading=\"lazy\" />\n          </a>\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b>\n                <span>${numberWithSpaces(likes)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b>\n                <span>${numberWithSpaces(views)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b>\n                <span>${numberWithSpaces(comments)}</span>\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b>\n                <span>${numberWithSpaces(downloads)}</span>\n              </p>\n            </div>\n          </li>`;\n      lightbox.refresh();\n      refs.gallery.insertAdjacentHTML('beforeend', imgMarkup);\n    }\n  );\n  checkPageNumber(page, totalHits);\n}\n\nfunction onLoadMoreClick(e) {\n  e.preventDefault();\n  page += 1;\n  fetchData(page, value);\n}\n\nfunction clearGallery() {\n  page = 1;\n  refs.gallery.innerHTML = '';\n  refs.loadMore.classList.add('hide');\n}\n\nfunction checkEmptyValue() {\n  if (value.length === 0) {\n    refs.input.value = '';\n    iziToast.warning({\n      message: 'You should enter something to input!',\n    });\n    return false;\n  }\n  return true;\n}\n\nfunction showLoadMore(totalHits) {\n  if (page >= Math.ceil(totalHits / 40)) {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    refs.loadMore.classList.add('hide');\n  } else {\n    refs.loadMore.classList.remove('hide');\n  }\n}\n\nfunction checkPageNumber(page, totalHits) {\n  if (page === 1) {\n    iziToast.success({\n      message: `Hooray! We found ${totalHits} images.`,\n    });\n  } else {\n    window.scrollBy({\n      top: window.innerHeight * 0.8,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction numberWithSpaces(num) {\n  return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n\nconst lightbox = new SimpleLightbox('.photo-card a', {\n  sourceAttr: 'href',\n  overlay: true,\n  nav: true,\n});\n"],"names":["iziToast","refs","onInputChange","onClickButton","onLoadMoreClick","value","page","clearGallery","checkEmptyValue","fetchData","fetchImages","data","createMarkup","err","hits","totalHits","showLoadMore","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgMarkup","numberWithSpaces","lightbox","checkPageNumber","num","SimpleLightbox"],"mappings":"wIAIAA,EAAS,SAAS,CAChB,SAAU,WACV,aAAc,eACd,cAAe,EACjB,CAAC,EAED,MAAMC,EAAO,CACX,MAAO,SAAS,cAAc,OAAO,EACrC,OAAQ,SAAS,cAAc,mBAAmB,EAClD,QAAS,SAAS,cAAc,UAAU,EAC1C,SAAU,SAAS,cAAc,eAAe,CAClD,EAEAA,EAAK,MAAM,iBAAiB,QAASC,CAAa,EAClDD,EAAK,OAAO,iBAAiB,QAASE,CAAa,EACnDF,EAAK,SAAS,iBAAiB,QAASG,CAAe,EAEvD,IAAIC,EAAQ,GACRC,EAAO,EAEX,SAASJ,EAAc,EAAG,CACxB,EAAE,eAAc,EAChBG,EAAQ,EAAE,OAAO,MAAM,KAAI,CAC7B,CAEA,SAASF,EAAc,EAAG,CACxB,EAAE,eAAc,EAChBI,IACAC,KAAqBC,EAAUH,EAAMD,CAAK,CAC5C,CAEA,SAASI,EAAUH,EAAMD,EAAO,CAC9BK,EAAYJ,EAAMD,CAAK,EACpB,KAAKM,GAAQ,CACZC,EAAaD,CAAI,CACvB,CAAK,EACA,MAAME,GAAO,CACZb,EAAS,MAAM,CACb,QAAS,2CACjB,CAAO,CACP,CAAK,CACL,CAEA,SAASY,EAAa,CAAE,KAAAE,EAAM,UAAAC,GAAa,CACzC,GAAID,EAAK,SAAW,EAClB,OAAOd,EAAS,KAAK,CACnB,QACE,0EACR,CAAK,EAEHgB,EAAaD,CAAS,EACtBD,EAAK,IACH,CAAC,CACC,aAAAG,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACN,IAAU,CACJ,MAAMC,EAAY;AAAA;AAAA,2CAEmBN;AAAA,uBACpBD,SAAoBE;AAAA;AAAA;AAAA;AAAA;AAAA,wBAKnBM,EAAiBL,CAAK;AAAA;AAAA;AAAA;AAAA,wBAItBK,EAAiBJ,CAAK;AAAA;AAAA;AAAA;AAAA,wBAItBI,EAAiBH,CAAQ;AAAA;AAAA;AAAA;AAAA,wBAIzBG,EAAiBF,CAAS;AAAA;AAAA;AAAA,iBAI5CG,EAAS,QAAO,EAChBzB,EAAK,QAAQ,mBAAmB,YAAauB,CAAS,CACvD,CACL,EACEG,EAAgBrB,EAAMS,CAAS,CACjC,CAEA,SAASX,EAAgB,EAAG,CAC1B,EAAE,eAAc,EAChBE,GAAQ,EACRG,EAAUH,EAAMD,CAAK,CACvB,CAEA,SAASE,GAAe,CACtBD,EAAO,EACPL,EAAK,QAAQ,UAAY,GACzBA,EAAK,SAAS,UAAU,IAAI,MAAM,CACpC,CAEA,SAASO,GAAkB,CACzB,OAAIH,EAAM,SAAW,GACnBJ,EAAK,MAAM,MAAQ,GACnBD,EAAS,QAAQ,CACf,QAAS,sCACf,CAAK,EACM,IAEF,EACT,CAEA,SAASgB,EAAaD,EAAW,CAC3BT,GAAQ,KAAK,KAAKS,EAAY,EAAE,GAClCf,EAAS,KAAK,CACZ,QAAS,4DACf,CAAK,EACDC,EAAK,SAAS,UAAU,IAAI,MAAM,GAElCA,EAAK,SAAS,UAAU,OAAO,MAAM,CAEzC,CAEA,SAAS0B,EAAgBrB,EAAMS,EAAW,CACpCT,IAAS,EACXN,EAAS,QAAQ,CACf,QAAS,oBAAoBe,WACnC,CAAK,EAED,OAAO,SAAS,CACd,IAAK,OAAO,YAAc,GAC1B,SAAU,QAChB,CAAK,CAEL,CAEA,SAASU,EAAiBG,EAAK,CAC7B,OAAOA,EAAI,SAAU,EAAC,QAAQ,wBAAyB,GAAG,CAC5D,CAEA,MAAMF,EAAW,IAAIG,EAAe,gBAAiB,CACnD,WAAY,OACZ,QAAS,GACT,IAAK,EACP,CAAC"}